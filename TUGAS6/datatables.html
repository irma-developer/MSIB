<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DataTable</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- DataTables + Buttons (Bootstrap 5 skin) -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">
</head>
<body class="p-3 p-md-4">
  <h4 class="mb-3">Daftar Mahasiswa</h4>

  <table id="example" class="table table-striped table-bordered" style="width:100%">
    <thead class="table-info">
      <tr>
        <th>NIM</th>
        <th>Nama</th>
        <th>Prodi</th>
        <th>Angkatan</th>
      </tr>
    </thead>
    <tbody id="tbody">
      <!-- diisi lewat JS -->
    </tbody>
  </table>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

  <!-- Buttons + Excel + Print -->
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>

  <script>
    const prodis = ['Sistem Informasi', 'Informatika', 'Teknik Komputer', 'Teknik Informatika', 'Bisnis Digital'];
    const angkatanList = [2021, 2022, 2023, 2024];
    const seedNames = [
      'Siti Irmawati','Najla','Syifa','Kamila','Lilis',
      'Budi','Andi','Rina','Dewi','Rizki','Agus','Nadia','Fajar','Aulia','Yusuf'
    ];

    const tbody = document.getElementById('tbody');
    let nimBase = 230001;

    for (let i = 0; i < 80; i++) {                
      const nim = (nimBase + i).toString();
      const nama = seedNames[i % seedNames.length] + (i >= seedNames.length ? ' ' + (i+1) : '');
      const prodi = prodis[i % prodis.length];
      const angkatan = angkatanList[i % angkatanList.length];

      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${nim}</td><td>${nama}</td><td>${prodi}</td><td>${angkatan}</td>`;
      tbody.appendChild(tr);
    }

    //  Buttons (Excel & Print)  //
    $(function(){
      $('#example').DataTable({
        dom: 'Bfrtip',               
        buttons: [
          {
            extend: 'excelHtml5',
            title: 'Daftar Mahasiswa',
            exportOptions: { columns: [0,1,2,3] }
          },
          {
            extend: 'print',
            title: 'Daftar Mahasiswa',
            messageTop: 'Dicetak dari Sistem â€” ' + new Date().toLocaleString(),
            exportOptions: { columns: [0,1,2,3] }
          }
        ],
        pageLength: 10,
        lengthMenu: [5,10,25,50,100],
      });
    });
  </script>
</body>
</html>
